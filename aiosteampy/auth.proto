syntax = "proto3";

enum EAuthTokenPlatformType {
  k_EAuthTokenPlatformType_Unknown = 0;
  k_EAuthTokenPlatformType_SteamClient = 1;
  k_EAuthTokenPlatformType_WebBrowser = 2;
  k_EAuthTokenPlatformType_MobileApp = 3;
}

enum EAuthSessionGuardType {
  k_EAuthSessionGuardType_Unknown = 0;
  k_EAuthSessionGuardType_None = 1;
  k_EAuthSessionGuardType_EmailCode = 2;
  k_EAuthSessionGuardType_DeviceCode = 3;
  k_EAuthSessionGuardType_DeviceConfirmation = 4;
  k_EAuthSessionGuardType_EmailConfirmation = 5;
  k_EAuthSessionGuardType_MachineToken = 6;
}



message CAuthentication_AllowedConfirmation {
  EAuthSessionGuardType confirmation_type = 1;
  string associated_message = 2;
}

message CAuthentication_BeginAuthSessionViaCredentials_Response {
  uint64 client_id = 1;
  bytes request_id = 2;
  float interval = 3;
  repeated CAuthentication_AllowedConfirmation allowed_confirmations = 4;
  uint64 steamid = 5;
  string weak_token = 6;
}


message AuthSession {
  string account_name = 2;
  string encrypted_password = 3;
  uint64 encryption_timestamp = 4;
  uint32 remember_login = 5;
  uint32 persistence = 7;
  string website_id = 8;
  message DeviceDetails {
    string device_friendly_name = 1;
    EAuthTokenPlatformType platform_type = 2;
  }
  DeviceDetails device_details = 9;
  uint32 additional_field = 11;
}


message CAuthentication_PollAuthSessionStatus_Request {
  uint64 client_id = 1;
  bytes request_id = 2;
}

message CAuthentication_PollAuthSessionStatus_Response {
  optional uint64 new_client_id = 1;
  optional string new_challenge_url = 2;
  string refresh_token = 3;
  string access_token = 4;
  bool had_remote_interaction = 5;
  string account_name = 6;
}

